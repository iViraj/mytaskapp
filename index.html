<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Task App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>My Task App</h1>
            <p id="current-date"></p>
        </header>
        
        <!-- Home Tab (Today's Tasks) -->
        <div id="home-tab" class="tab-content active">
            <h2>Today's Tasks</h2>
            <div id="today-tasks">
                <!-- Today's tasks will be loaded here -->
                <div class="empty-state">
                    <i class="fas fa-tasks"></i>
                    <p>No tasks for today</p>
                </div>
            </div>
        </div>
        
        <!-- Add New Tab -->
        <div id="add-tab" class="tab-content">
            <div class="card">
                <button id="show-task-form" class="action-btn">ADD WEEKDAYS TASK</button>
                <button id="show-goal-form" class="action-btn">ADD GOALS</button>
                <button id="show-remove-form" class="action-btn">REMOVE TASK/GOALS</button>
            </div>
            
            <!-- Add Task Form -->
            <div id="task-form" class="card hidden">
                <h3>Add Weekday Task</h3>
                <div class="form-group">
                    <label for="task-title">Title</label>
                    <input type="text" id="task-title" placeholder="Enter task title">
                </div>
                <div class="form-group">
                    <label for="task-desc">Description</label>
                    <textarea id="task-desc" placeholder="Enter task description"></textarea>
                </div>
                <div class="form-group">
                    <label>Select Days</label>
                    <div class="day-checkboxes">
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-mon" value="Monday">
                            <label for="day-mon">Mon</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-tue" value="Tuesday">
                            <label for="day-tue">Tue</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-wed" value="Wednesday">
                            <label for="day-wed">Wed</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-thu" value="Thursday">
                            <label for="day-thu">Thu</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-fri" value="Friday">
                            <label for="day-fri">Fri</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-sat" value="Saturday">
                            <label for="day-sat">Sat</label>
                        </div>
                        <div class="day-checkbox">
                            <input type="checkbox" id="day-sun" value="Sunday">
                            <label for="day-sun">Sun</label>
                        </div>
                    </div>
                </div>
                <button id="save-task">Save Task</button>
            </div>
            
            <!-- Add Goal Form -->
            <div id="goal-form" class="card hidden">
                <h3>Add Goal</h3>
                <div class="form-group">
                    <label for="goal-title">Title</label>
                    <input type="text" id="goal-title" placeholder="Enter goal title">
                </div>
                <div class="form-group">
                    <label for="goal-desc">Description</label>
                    <textarea id="goal-desc" placeholder="Enter goal description"></textarea>
                </div>
                <div class="form-group">
                    <label for="goal-start">Start From</label>
                    <input type="date" id="goal-start">
                </div>
                <div class="form-group">
                    <label for="goal-deadline">Deadline</label>
                    <input type="date" id="goal-deadline">
                </div>
                <button id="save-goal">Save Goal</button>
            </div>
            
            <!-- Remove Tasks/Goals Form -->
            <div id="remove-form" class="card hidden">
                <h3>Remove Tasks/Goals</h3>
                <div id="items-list">
                    <!-- Tasks and goals will be listed here -->
                    <div class="empty-state">
                        <i class="fas fa-trash-alt"></i>
                        <p>No items to remove</p>
                    </div>
                </div>
                
                <div class="import-export">
                    <button id="import-data">Import Data</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                </div>
            </div>
        </div>
        
        <!-- All Tab -->
        <div id="all-tab" class="tab-content">
            <h2>All Tasks and Goals</h2>
            <div id="all-content">
                <!-- Weekday tasks and goals will be loaded here -->
                <div class="empty-state">
                    <i class="fas fa-folder-open"></i>
                    <p>No tasks or goals yet</p>
                </div>
            </div>
            
            <div class="import-export">
                <button id="export-data">Export Data</button>
            </div>
        </div>
    </div>
    
    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-item" data-tab="add-tab">
            <i class="fas fa-plus-circle"></i>
            <span>Add New</span>
        </div>
        <div class="nav-item active" data-tab="home-tab">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="nav-item" data-tab="all-tab">
            <i class="fas fa-list-alt"></i>
            <span>All</span>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3 id="modal-title">Edit Item</h3>
            <div id="modal-content">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        Operation completed successfully!
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Display current date
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = now.toLocaleDateString('en-US', options);
            
            // Initialize data
            initializeData();
            
            // Set up tab navigation
            setupTabs();
            
            // Set up form handlers
            setupForms();
            
            // Load data for display
            loadHomeTab();
            loadRemoveTab();
            loadAllTab();
            
            // Set up midnight refresh
            setupMidnightRefresh();
        });
        
        // Data initialization
        function initializeData() {
            if (!localStorage.getItem('tasks')) {
                localStorage.setItem('tasks', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('goals')) {
                localStorage.setItem('goals', JSON.stringify([]));
            }
            
            // Initialize daily checklists if not exists or if it's a new day
            const today = new Date().toDateString();
            const lastChecklistDate = localStorage.getItem('lastChecklistDate');
            
            if (!localStorage.getItem('dailyChecklist') || lastChecklistDate !== today) {
                localStorage.setItem('dailyChecklist', JSON.stringify({}));
                localStorage.setItem('lastChecklistDate', today);
            }
        }
        
        // Tab navigation setup
        function setupTabs() {
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Update active tab
                    document.querySelectorAll('.tab-content').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                    
                    // Update active nav item
                    document.querySelectorAll('.nav-item').forEach(nav => {
                        nav.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Load appropriate data when switching tabs
                    if (tabId === 'home-tab') {
                        loadHomeTab();
                    } else if (tabId === 'add-tab') {
                        // Reset forms when switching to add tab
                        document.getElementById('task-form').classList.add('hidden');
                        document.getElementById('goal-form').classList.add('hidden');
                        document.getElementById('remove-form').classList.add('hidden');
                    } else if (tabId === 'all-tab') {
                        loadAllTab();
                    }
                });
            });
            
            // Add New tab buttons
            document.getElementById('show-task-form').addEventListener('click', function() {
                document.getElementById('task-form').classList.remove('hidden');
                document.getElementById('goal-form').classList.add('hidden');
                document.getElementById('remove-form').classList.add('hidden');
            });
            
            document.getElementById('show-goal-form').addEventListener('click', function() {
                document.getElementById('task-form').classList.add('hidden');
                document.getElementById('goal-form').classList.remove('hidden');
                document.getElementById('remove-form').classList.add('hidden');
            });
            
            document.getElementById('show-remove-form').addEventListener('click', function() {
                document.getElementById('task-form').classList.add('hidden');
                document.getElementById('goal-form').classList.add('hidden');
                document.getElementById('remove-form').classList.remove('hidden');
                loadRemoveTab();
            });
        }
        
        // Form handlers setup
        function setupForms() {
            // Save task
            document.getElementById('save-task').addEventListener('click', function() {
                const title = document.getElementById('task-title').value.trim();
                const description = document.getElementById('task-desc').value.trim();
                const days = [];
                
                // Get selected days
                document.querySelectorAll('.day-checkbox input:checked').forEach(checkbox => {
                    days.push(checkbox.value);
                });
                
                if (!title || days.length === 0) {
                    alert('Please provide a title and select at least one day');
                    return;
                }
                
                const tasks = JSON.parse(localStorage.getItem('tasks'));
                const newTask = {
                    id: Date.now(),
                    title,
                    description,
                    days,
                    createdAt: new Date().toISOString()
                };
                
                tasks.push(newTask);
                localStorage.setItem('tasks', JSON.stringify(tasks));
                
                // Reset form
                document.getElementById('task-title').value = '';
                document.getElementById('task-desc').value = '';
                document.querySelectorAll('.day-checkbox input').forEach(checkbox => {
                    checkbox.checked = false;
                });
                
                showNotification('Task saved successfully!');
            });
            
            // Save goal
            document.getElementById('save-goal').addEventListener('click', function() {
                const title = document.getElementById('goal-title').value.trim();
                const description = document.getElementById('goal-desc').value.trim();
                const startFrom = document.getElementById('goal-start').value;
                const deadline = document.getElementById('goal-deadline').value;
                
                if (!title || !startFrom || !deadline) {
                    alert('Please provide title, start date, and deadline');
                    return;
                }
                
                const goals = JSON.parse(localStorage.getItem('goals'));
                const newGoal = {
                    id: Date.now(),
                    title,
                    description,
                    startFrom,
                    deadline,
                    createdAt: new Date().toISOString()
                };
                
                goals.push(newGoal);
                localStorage.setItem('goals', JSON.stringify(goals));
                
                // Reset form
                document.getElementById('goal-title').value = '';
                document.getElementById('goal-desc').value = '';
                document.getElementById('goal-start').value = '';
                document.getElementById('goal-deadline').value = '';
                
                showNotification('Goal saved successfully!');
            });
            
            // Export data
            document.getElementById('export-data').addEventListener('click', function() {
                const tasks = JSON.parse(localStorage.getItem('tasks'));
                const goals = JSON.parse(localStorage.getItem('goals'));
                
                const data = {
                    tasks,
                    goals,
                    exportedAt: new Date().toISOString()
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `my-task-app-backup-${new Date().toISOString().slice(0, 10)}.json`;
                link.click();
                
                showNotification('Data exported successfully!');
            });
            
            // Import data
            document.getElementById('import-data').addEventListener('click', function() {
                document.getElementById('import-file').click();
            });
            
            document.getElementById('import-file').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (data.tasks && data.goals) {
                            // Clear existing data before importing
                            localStorage.setItem('tasks', JSON.stringify(data.tasks));
                            localStorage.setItem('goals', JSON.stringify(data.goals));
                            
                            showNotification('Data imported successfully!');
                            loadRemoveTab();
                            loadAllTab();
                            loadHomeTab();
                        } else {
                            alert('Invalid file format');
                        }
                    } catch (error) {
                        alert('Error parsing JSON file');
                    }
                };
                reader.readAsText(file);
            });
            
            // Modal close button
            document.querySelector('.close-modal').addEventListener('click', function() {
                document.getElementById('edit-modal').style.display = 'none';
            });
        }
        
        // Load home tab with today's tasks
        function loadHomeTab() {
            const today = new Date();
            const dayName = today.toLocaleDateString('en-US', { weekday: 'long' });
            const tasks = JSON.parse(localStorage.getItem('tasks'));
            const goals = JSON.parse(localStorage.getItem('goals'));
            const dailyChecklist = JSON.parse(localStorage.getItem('dailyChecklist'));
            
            const todayTasks = tasks.filter(task => task.days.includes(dayName));
            const todayGoals = goals.filter(goal => {
                const goalDate = new Date(goal.deadline);
                return goalDate.toDateString() === today.toDateString();
            });
            
            const todayTasksElement = document.getElementById('today-tasks');
            todayTasksElement.innerHTML = '';
            
            if (todayTasks.length === 0 && todayGoals.length === 0) {
                todayTasksElement.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tasks"></i>
                        <p>No tasks for today</p>
                    </div>
                `;
                return;
            }
            
            // Add today's tasks
            todayTasks.forEach(task => {
                const isChecked = dailyChecklist[task.id] || false;
                
                const taskElement = document.createElement('div');
                taskElement.className = 'task-item';
                taskElement.innerHTML = `
                    <div class="task-header">
                        <div class="task-title">${task.title}</div>
                    </div>
                    <div class="task-desc">${task.description}</div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="check-${task.id}" ${isChecked ? 'checked' : ''}>
                        <label for="check-${task.id}">Mark as completed</label>
                    </div>
                `;
                
                todayTasksElement.appendChild(taskElement);
                
                // Add event listener for checkbox
                const checkbox = taskElement.querySelector(`#check-${task.id}`);
                checkbox.addEventListener('change', function() {
                    const checklist = JSON.parse(localStorage.getItem('dailyChecklist'));
                    checklist[task.id] = this.checked;
                    localStorage.setItem('dailyChecklist', JSON.stringify(checklist));
                });
            });
            
            // Add today's goals
            todayGoals.forEach(goal => {
                const isChecked = dailyChecklist[goal.id] || false;
                
                const goalElement = document.createElement('div');
                goalElement.className = 'goal-item';
                goalElement.innerHTML = `
                    <div class="goal-header">
                        <div class="goal-title">${goal.title}</div>
                    </div>
                    <div class="goal-dates">Deadline: ${new Date(goal.deadline).toLocaleDateString()}</div>
                    <div class="goal-desc">${goal.description}</div>
                    <div class="checkbox-container">
                        <input type="checkbox" id="check-${goal.id}" ${isChecked ? 'checked' : ''}>
                        <label for="check-${goal.id}">Mark as completed</label>
                    </div>
                `;
                
                todayTasksElement.appendChild(goalElement);
                
                // Add event listener for checkbox
                const checkbox = goalElement.querySelector(`#check-${goal.id}`);
                checkbox.addEventListener('change', function() {
                    const checklist = JSON.parse(localStorage.getItem('dailyChecklist'));
                    checklist[goal.id] = this.checked;
                    localStorage.setItem('dailyChecklist', JSON.stringify(checklist));
                });
            });
        }
        
        // Load remove tab with all tasks and goals
        function loadRemoveTab() {
            const tasks = JSON.parse(localStorage.getItem('tasks'));
            const goals = JSON.parse(localStorage.getItem('goals'));
            const itemsListElement = document.getElementById('items-list');
            
            itemsListElement.innerHTML = '';
            
            if (tasks.length === 0 && goals.length === 0) {
                itemsListElement.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-trash-alt"></i>
                        <p>No items to remove</p>
                    </div>
                `;
                return;
            }
            
            // Add tasks to remove list
            tasks.forEach(task => {
                const itemElement = document.createElement('div');
                itemElement.className = 'task-item';
                itemElement.innerHTML = `
                    <div class="task-header">
                        <div class="task-title">${task.title}</div>
                    </div>
                    <div class="subheader">TYPE: Task for ${task.days.join(', ')}</div>
                    <div class="task-desc">${task.description}</div>
                    <div class="action-buttons">
                        <button class="action-btn edit-btn" data-id="${task.id}" data-type="task">‚úèÔ∏è Edit</button>
                        <button class="action-btn delete-btn" data-id="${task.id}" data-type="task">üóëÔ∏è Delete</button>
                    </div>
                `;
                
                itemsListElement.appendChild(itemElement);
            });
            
            // Add goals to remove list
            goals.forEach(goal => {
                const itemElement = document.createElement('div');
                itemElement.className = 'goal-item';
                itemElement.innerHTML = `
                    <div class="goal-header">
                        <div class="goal-title">${goal.title}</div>
                    </div>
                    <div class="subheader">TYPE: Goal (${new Date(goal.startFrom).toLocaleDateString()} - ${new Date(goal.deadline).toLocaleDateString()})</div>
                    <div class="goal-desc">${goal.description}</div>
                    <div class="action-buttons">
                        <button class="action-btn edit-btn" data-id="${goal.id}" data-type="goal">‚úèÔ∏è Edit</button>
                        <button class="action-btn delete-btn" data-id="${goal.id}" data-type="goal">üóëÔ∏è Delete</button>
                    </div>
                `;
                
                itemsListElement.appendChild(itemElement);
            });
            
            // Add event listeners for delete buttons
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    const type = this.getAttribute('data-type');
                    
                    if (confirm(`Are you sure you want to delete this ${type}?`)) {
                        if (type === 'task') {
                            const tasks = JSON.parse(localStorage.getItem('tasks'));
                            const updatedTasks = tasks.filter(task => task.id !== parseInt(id));
                            localStorage.setItem('tasks', JSON.stringify(updatedTasks));
                        } else {
                            const goals = JSON.parse(localStorage.getItem('goals'));
                            const updatedGoals = goals.filter(goal => goal.id !== parseInt(id));
                            localStorage.setItem('goals', JSON.stringify(updatedGoals));
                        }
                        
                        showNotification(`${type.charAt(0).toUpperCase() + type.slice(1)} deleted successfully!`);
                        loadRemoveTab();
                        loadAllTab();
                        loadHomeTab();
                    }
                });
            });
            
            // Add event listeners for edit buttons
            document.querySelectorAll('.edit-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    const type = this.getAttribute('data-type');
                    
                    openEditModal(parseInt(id), type);
                });
            });
        }
        
        // Load all tab with categorized tasks and goals
        function loadAllTab() {
            const tasks = JSON.parse(localStorage.getItem('tasks'));
            const goals = JSON.parse(localStorage.getItem('goals'));
            const allContentElement = document.getElementById('all-content');
            
            allContentElement.innerHTML = '';
            
            if (tasks.length === 0 && goals.length === 0) {
                allContentElement.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-folder-open"></i>
                        <p>No tasks or goals yet</p>
                    </div>
                `;
                return;
            }
            
            // Group tasks by day
            const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            const tasksByDay = {};
            
            daysOfWeek.forEach(day => {
                tasksByDay[day] = tasks.filter(task => task.days.includes(day));
            });
            
            // Add weekday sections
            const weekdaySection = document.createElement('div');
            weekdaySection.className = 'weekday-section';
            weekdaySection.innerHTML = '<div class="section-title">Weekday Tasks</div>';
            
            daysOfWeek.forEach(day => {
                if (tasksByDay[day].length > 0) {
                    const daySection = document.createElement('div');
                    daySection.innerHTML = `<h3>${day}</h3>`;
                    
                    tasksByDay[day].forEach(task => {
                        const taskElement = document.createElement('div');
                        taskElement.className = 'task-item';
                        taskElement.innerHTML = `
                            <div class="task-header">
                                <div class="task-title">${task.title}</div>
                            </div>
                            <div class="task-desc">${task.description}</div>
                            <div class="days-container">
                                ${task.days.map(day => `<span class="day-pill">${day.substring(0, 3)}</span>`).join('')}
                            </div>
                        `;
                        
                        daySection.appendChild(taskElement);
                    });
                    
                    weekdaySection.appendChild(daySection);
                }
            });
            
            allContentElement.appendChild(weekdaySection);
            
            // Add goals section
            if (goals.length > 0) {
                const goalsSection = document.createElement('div');
                goalsSection.className = 'goals-section';
                goalsSection.innerHTML = '<div class="section-title">Goals</div>';
                
                // Sort goals by date modified (createdAt) ascending
                const sortedGoals = goals.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
                
                sortedGoals.forEach(goal => {
                    const goalElement = document.createElement('div');
                    goalElement.className = 'goal-item';
                    goalElement.innerHTML = `
                        <div class="goal-header">
                            <div class="goal-title">${goal.title}</div>
                        </div>
                        <div class="goal-dates">${new Date(goal.startFrom).toLocaleDateString()} - ${new Date(goal.deadline).toLocaleDateString()}</div>
                        <div class="goal-desc">${goal.description}</div>
                    `;
                    
                    goalsSection.appendChild(goalElement);
                });
                
                allContentElement.appendChild(goalsSection);
            }
        }
        
        // Set up midnight refresh for daily checklist
        function setupMidnightRefresh() {
            // Check if we need to reset the daily checklist
            const today = new Date().toDateString();
            const lastChecklistDate = localStorage.getItem('lastChecklistDate');
            
            if (lastChecklistDate !== today) {
                localStorage.setItem('dailyChecklist', JSON.stringify({}));
                localStorage.setItem('lastChecklistDate', today);
            }
            
            // Set up a timer to check for midnight
            const now = new Date();
            const midnight = new Date();
            midnight.setHours(24, 0, 0, 0);
            
            const timeUntilMidnight = midnight - now;
            
            setTimeout(function() {
                localStorage.setItem('dailyChecklist', JSON.stringify({}));
                localStorage.setItem('lastChecklistDate', new Date().toDateString());
                
                // Set up the next midnight refresh
                setupMidnightRefresh();
            }, timeUntilMidnight + 1000); // Add 1 second to ensure it's past midnight
        }
        
        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(function() {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Open edit modal
        function openEditModal(id, type) {
            const modal = document.getElementById('edit-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            
            if (type === 'task') {
                const tasks = JSON.parse(localStorage.getItem('tasks'));
                const task = tasks.find(t => t.id === id);
                
                modalTitle.textContent = 'Edit Task';
                modalContent.innerHTML = `
                    <div class="form-group">
                        <label for="edit-task-title">Title</label>
                        <input type="text" id="edit-task-title" value="${task.title}" placeholder="Enter task title">
                    </div>
                    <div class="form-group">
                        <label for="edit-task-desc">Description</label>
                        <textarea id="edit-task-desc" placeholder="Enter task description">${task.description}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Select Days</label>
                        <div class="day-checkboxes">
                            ${['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'].map(day => `
                                <div class="day-checkbox">
                                    <input type="checkbox" id="edit-day-${day.toLowerCase()}" value="${day}" ${task.days.includes(day) ? 'checked' : ''}>
                                    <label for="edit-day-${day.toLowerCase()}">${day.substring(0, 3)}</label>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <button id="update-task">Update Task</button>
                `;
                
                // Add event listener for update button
                modalContent.querySelector('#update-task').addEventListener('click', function() {
                    const title = modalContent.querySelector('#edit-task-title').value.trim();
                    const description = modalContent.querySelector('#edit-task-desc').value.trim();
                    const days = [];
                    
                    // Get selected days
                    modalContent.querySelectorAll('.day-checkbox input:checked').forEach(checkbox => {
                        days.push(checkbox.value);
                    });
                    
                    if (!title || days.length === 0) {
                        alert('Please provide a title and select at least one day');
                        return;
                    }
                    
                    // Update task
                    task.title = title;
                    task.description = description;
                    task.days = days;
                    
                    localStorage.setItem('tasks', JSON.stringify(tasks));
                    modal.style.display = 'none';
                    
                    showNotification('Task updated successfully!');
                    loadRemoveTab();
                    loadAllTab();
                    loadHomeTab();
                });
                
            } else if (type === 'goal') {
                const goals = JSON.parse(localStorage.getItem('goals'));
                const goal = goals.find(g => g.id === id);
                
                modalTitle.textContent = 'Edit Goal';
                modalContent.innerHTML = `
                    <div class="form-group">
                        <label for="edit-goal-title">Title</label>
                        <input type="text" id="edit-goal-title" value="${goal.title}" placeholder="Enter goal title">
                    </div>
                    <div class="form-group">
                        <label for="edit-goal-desc">Description</label>
                        <textarea id="edit-goal-desc" placeholder="Enter goal description">${goal.description}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-goal-start">Start From</label>
                        <input type="date" id="edit-goal-start" value="${goal.startFrom}">
                    </div>
                    <div class="form-group">
                        <label for="edit-goal-deadline">Deadline</label>
                        <input type="date" id="edit-goal-deadline" value="${goal.deadline}">
                    </div>
                    <button id="update-goal">Update Goal</button>
                `;
                
                // Add event listener for update button
                modalContent.querySelector('#update-goal').addEventListener('click', function() {
                    const title = modalContent.querySelector('#edit-goal-title').value.trim();
                    const description = modalContent.querySelector('#edit-goal-desc').value.trim();
                    const startFrom = modalContent.querySelector('#edit-goal-start').value;
                    const deadline = modalContent.querySelector('#edit-goal-deadline').value;
                    
                    if (!title || !startFrom || !deadline) {
                        alert('Please provide title, start date, and deadline');
                        return;
                    }
                    
                    // Update goal
                    goal.title = title;
                    goal.description = description;
                    goal.startFrom = startFrom;
                    goal.deadline = deadline;
                    
                    localStorage.setItem('goals', JSON.stringify(goals));
                    modal.style.display = 'none';
                    
                    showNotification('Goal updated successfully!');
                    loadRemoveTab();
                    loadAllTab();
                    loadHomeTab();
                });
            }
            
            modal.style.display = 'flex';
        }
    </script>
</body>
</html>
